# MNIST Classification Project

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π MNIST —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PyTorch –∏ MLflow.  
–û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ ‚Äî —Ñ—É–Ω–∫—Ü–∏—è main() –≤ train.py.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

‚îú‚îÄ‚îÄ config.py  
‚îú‚îÄ‚îÄ model.py  
‚îú‚îÄ‚îÄ train.py  
‚îú‚îÄ‚îÄ train_utils.py  
‚îú‚îÄ‚îÄ tests/  
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py  
‚îÇ   ‚îî‚îÄ‚îÄ test_model.py  
‚îî‚îÄ‚îÄ .venv/

---

##  –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

- train.py  
  –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –§—É–Ω–∫—Ü–∏—è main() —Å–æ–∑–¥–∞—ë—Ç –∏ –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å.

- model.py  
  –°–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏.

- train_utils.py  
  –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—å—é.

- config.py  
  –§–∞–π–ª —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π:
  
  BATCH_SIZE = 256  
  LEARNING_RATE = 0.1  
  EPOCHS = 1  
  DEVICE = torch.device('cuda' if torch.cuda.is_available() else 'cpu')

- tests/test_model.py  
  –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ run_and_log_tests().

---

##  –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –§—É–Ω–∫—Ü–∏–∏ get_loaders() –∏ train_model() –∏–∑ train_utils.py –æ–±—ë—Ä–Ω—É—Ç—ã –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞–º–∏ log_loaders –∏ log_train_model –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.

- –ú–µ—Ç—Ä–∏–∫–∏ train_loss, train_accuracy, test_loss, test_accuracy –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π evaluate_and_log_metrics() –∏–∑ train.py.

- –¢–µ—Å—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é run_and_log_tests() –∏–∑ tests/test_model.py.

---

## –í–∞–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –º–æ–∂–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:  
"Registered model 'MNISTClassifier' already exists."  
–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –º–æ–¥–µ–ª–∏. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

---

## üíª –ó–∞–ø—É—Å–∫ MLflow UI (Arch Linux)

1. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:  
   source .venv/bin/activate.fish

2. –ó–∞–ø—É—Å—Ç–∏—Ç—å MLflow UI:  
   mlflow ui

3. –ü–µ—Ä–µ–π—Ç–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:  
   http://127.0.0.1:5000

---

## –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–í MLflow UI:
- –û—Ç–∫—Ä—ã—Ç—å Experiments ‚Üí MNIST_Classification.
- –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π –∑–∞–ø—É—Å–∫.

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–ø—É—Å–∫–∞:
- Overview ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.
- Artifacts:
  - data_info/ ‚Äî –¥–∞–Ω–Ω—ã–µ –æ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö.
  - documentation/ ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ –∑–∞–ø—É—Å–∫–µ.
  - test_reports/ ‚Äî –æ—Ç—á—ë—Ç—ã –æ —Ç–µ—Å—Ç–∞—Ö.
- –í model/data:
  - model.pth ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏.
  - pickle_module_info.txt ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ –≤–∫–ª–∞–¥–∫–µ Models –≤ MLflow UI.

![test_main](photos/test_main.png)
![artifacts](photos/artifacts.png)
![model](photos/model.png)

---

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

torch  
torchvision  
torch.nn  
torch.nn.functional  
torch.optim  
torch.utils.data  
mlflow  
mlflow.data  
mlflow.tracking  
pytest  
datetime  
pathlib  
os  
inspect  
functools  
math
